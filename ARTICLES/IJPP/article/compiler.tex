%--------------------
\subsection{Overall compiler algorithm}

The overall compiler algorithm is represented in Algorithm~\ref{alg:compiler}. First, the parsing of the input file (written with the MSL language) gave enough information to build $\Gamma$, the ordered list of computation kernels. Second, $\Gamma_{sync}$ and $\Gamma_{dep}$ can be built from $\Gamma$ using the recursive functions $F_{sync}$ and $F_{dep}$. Third, N-Shapes are removed from $\Gamma_{dep}$ to get a MSPD graph, and to be able to create its serie-parallel binary tree decomposition $TSP$ (line 6). If only a data parallelization has been chosen, Line 8 performs the fusion of kernels. Finally a dump of $TSP$ is performed by the compiler. Implementation choices of the dump are described in the next subsection.

\begin{algorithm}
\caption{MSL Compiler}
\label{alg:compiler}
\begin{algorithmic}[1]
\Procedure{compileMSL} {file}
\State $\Gamma$ = parser(file)
\State $\Gamma_{sync} = F_{sync}(\Gamma,0)$
\State $\Gamma_{dep} = F_{dep}(\Gamma_{sync},0)$
\State removeNSH($\Gamma_{dep}$)
\State $TSP = F_{tsp}(TSP,root(TSP))$
\If {data parallel}
\State $TSP = F_{fus}(TSP)$
\EndIf
\State dump(TSP)
\EndProcedure
\end{algorithmic}
\end{algorithm}

%--------------------
\subsection{Implementation choices}

SkelGIS + OpenMP + L2C

