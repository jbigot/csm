In this paper, we have presented MSF, a multi-stencil framework.
MSF is built upon a meta-formalism of a multi-stencil program that we have presented in Section~\ref{sect:formalism}.
From this meta-formalism, we have designed, first, the generic component assembly of a multi-stencil program, and second, the domain specific language MSL that enables the description of a specific application by a numerician.
From these entries, MSC, the MSF compiler, automatically generates a parallel component assembly.
This assembly represents the parallel orchestration of computations, independently of implementation choices. Two parallelization strategies are supported: data parallelization and hybrid (data and task) parallelization.

By combining a meta-model and component-based programming, MSF has the particularity to enhance separation of concerns, as well as code-reuse and composition of existing solutions (\eg SkelGIS and OpenMP in this paper).
MSF has been evaluated on the real case simulation FullSWOF2D.
Results show that the MSF runtime does not induce unwanted overheads for its data parallelization technique on both strong and weak scalings.
Results also show that the hybrid parallelization supported by MSF can increase performance when the data parallelism exposed by the simulation is not enough, which is a new contribution compared to existing solutions.
Finally, we have evaluated the fusion optimization and shown that it often increases performance but it is not always a good choice, particularly when performing hybrid parallelism.

Many perspectives of future work raise from this paper. First, even if using one distributed data structure or another is possible and facilitated by MSF, the HPC specialist still has to understand component programming models and the meta-model of the framework to add new implementation of $DDS$ and $Data$ components. We think it could be interesting to also facilitate the work of the HPC specialist by proposing a semi-automated framework to add new implementations of these components to MSF.

Second, it has been shown in the performance model and evaluation results that the choice between data parallelism and hybrid parallelism in not trivial. It depends on the time spent in computations, the number of cores and nodes used for the execution, as well as the network behavior (Figure~\ref{fig:limit} and~\ref{fig:close}). MSF, thanks to its meta-formalism and to the use of component models, easily handles the activation of one parallelism technique or another. Thus, MSF can be considered as a performance leverage for multi-stencil programs. However, it would be interesting to investigate how an algorithm could choose the best parallelization technique for a given execution of a multi-stencil simulation.

The same choice problem is raised by the fusion optimization. For the same reasons an algorithm could choose the best solution for a given execution. To design such an algorithm different solutions should be studied, such as following an approximated behavior model, or using calibration runs to then use deep learning algorithms, etc.

Finally, by using component models doors are opened to reconfiguration of applications~\cite{Lanore:2015:RCM:2737166.2737169} which means that the application could adapt its behavior and structure to external events.
